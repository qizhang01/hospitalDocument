<template>
  <Graphics
    v-if="graphicsDataDone"
    :value="resInfo"
    @done="printPage"
    print
  ></Graphics>
</template>

<script setup>
import Graphics from './downBtn.vue'
import data from './temperature-chart/datas'
import { ref, onMounted, watch } from "vue";
let printData = {}
const resInfo = ref({})
const graphicsDataDone = ref(false)
const printPromiseReslove = ref(null)

const dateClosed = ref({
        stopTime: true, // 控制结束日期
        stopNumber: true // 控制住院天数 
})

onMounted(() => {
  const jsonStr = '[{"grParamBOS":[{"age":66,"ageunit":"岁","beginDate":"2020-12-25","cwh":"1011","hospCode":"0000000006","originName":"测试医院名称","hospDate":1608889359000,"hospDays":0,"inDate":1611666680000,"inDiagName":"上呼吸道感染","name":"患者9","officeName":"住院科室","operaDays":null,"sex":"男","weekNo":"0"}],"rows":[{"rowBOS":[{"date":"2020-12-25","times":"03:00:00","typeCode":"012","typeValue":"外出"},{"date":"2020-12-25","times":"03:00:00","typeCode":"001","typeValue":"30"},{"date":"2020-12-25","times":"03:00:00","typeCode":"002","typeValue":"88"},{"date":"2020-12-25","times":"03:00:00","typeCode":"014","typeValue":"60"},{"date":"2020-12-25","times":"03:00:00","typeCode":"003","typeValue":"36"},{"date":"2020-12-25","times":"03:00:00","typeCode":"015","typeValue":"37"},{"date":"2020-12-25","times":"03:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-25","times":"07:00:00","typeCode":"012","typeValue":"外出"},{"date":"2020-12-25","times":"07:00:00","typeCode":"001","typeValue":"30"},{"date":"2020-12-25","times":"07:00:00","typeCode":"002","typeValue":"88"},{"date":"2020-12-25","times":"07:00:00","typeCode":"014","typeValue":"66"},{"date":"2020-12-25","times":"07:00:00","typeCode":"003","typeValue":"36"},{"date":"2020-12-25","times":"07:00:00","typeCode":"015","typeValue":"37"},{"date":"2020-12-25","times":"07:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-25","times":"11:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-25","times":"11:00:00","typeCode":"001","typeValue":"30"},{"date":"2020-12-25","times":"11:00:00","typeCode":"002","typeValue":"88"},{"date":"2020-12-25","times":"11:00:00","typeCode":"014","typeValue":"66"},{"date":"2020-12-25","times":"11:00:00","typeCode":"003","typeValue":"37"},{"date":"2020-12-25","times":"11:00:00","typeCode":"015","typeValue":"38"},{"date":"2020-12-25","times":"11:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-25","times":"15:00:00","typeCode":"012","typeValue":"请假"},{"date":"2020-12-25","times":"15:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-25","times":"15:00:00","typeCode":"002","typeValue":"88"},{"date":"2020-12-25","times":"15:00:00","typeCode":"014","typeValue":"66"},{"date":"2020-12-25","times":"15:00:00","typeCode":"003","typeValue":"35"},{"date":"2020-12-25","times":"15:00:00","typeCode":"015","typeValue":"39"},{"date":"2020-12-25","times":"15:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-25","times":"19:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-25","times":"19:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-25","times":"19:00:00","typeCode":"002","typeValue":"88"},{"date":"2020-12-25","times":"19:00:00","typeCode":"014","typeValue":"66"},{"date":"2020-12-25","times":"19:00:00","typeCode":"003","typeValue":"36"},{"date":"2020-12-25","times":"19:00:00","typeCode":"015","typeValue":"38"},{"date":"2020-12-25","times":"19:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-25","times":"23:00:00","typeCode":"012","typeValue":"介入"},{"date":"2020-12-25","times":"23:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-25","times":"23:00:00","typeCode":"002","typeValue":"88"},{"date":"2020-12-25","times":"23:00:00","typeCode":"014","typeValue":"66"},{"date":"2020-12-25","times":"23:00:00","typeCode":"003","typeValue":"37"},{"date":"2020-12-25","times":"23:00:00","typeCode":"015","typeValue":"37"},{"date":"2020-12-25","times":"23:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-26","times":"03:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-26","times":"03:00:00","typeCode":"001","typeValue":"33"},{"date":"2020-12-26","times":"03:00:00","typeCode":"002","typeValue":"88"},{"date":"2020-12-26","times":"03:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-26","times":"03:00:00","typeCode":"003","typeValue":"38"},{"date":"2020-12-26","times":"03:00:00","typeCode":"015","typeValue":"39"},{"date":"2020-12-26","times":"03:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-26","times":"07:00:00","typeCode":"012","typeValue":"介入"},{"date":"2020-12-26","times":"07:00:00","typeCode":"001","typeValue":"33"},{"date":"2020-12-26","times":"07:00:00","typeCode":"002","typeValue":"90"},{"date":"2020-12-26","times":"07:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-26","times":"07:00:00","typeCode":"003","typeValue":"38"},{"date":"2020-12-26","times":"07:00:00","typeCode":"015","typeValue":"39"},{"date":"2020-12-26","times":"07:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-26","times":"11:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-26","times":"11:00:00","typeCode":"001","typeValue":"33"},{"date":"2020-12-26","times":"11:00:00","typeCode":"002","typeValue":"90"},{"date":"2020-12-26","times":"11:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-26","times":"11:00:00","typeCode":"003","typeValue":"38"},{"date":"2020-12-26","times":"11:00:00","typeCode":"015","typeValue":"39"},{"date":"2020-12-26","times":"11:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-26","times":"15:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-26","times":"15:00:00","typeCode":"001","typeValue":"33"},{"date":"2020-12-26","times":"15:00:00","typeCode":"002","typeValue":"90"},{"date":"2020-12-26","times":"15:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-26","times":"15:00:00","typeCode":"003","typeValue":"38"},{"date":"2020-12-26","times":"15:00:00","typeCode":"015","typeValue":"39"},{"date":"2020-12-26","times":"15:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-26","times":"19:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-26","times":"19:00:00","typeCode":"001","typeValue":"35"},{"date":"2020-12-26","times":"19:00:00","typeCode":"002","typeValue":"90"},{"date":"2020-12-26","times":"19:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-26","times":"19:00:00","typeCode":"003","typeValue":"38"},{"date":"2020-12-26","times":"19:00:00","typeCode":"015","typeValue":"39"},{"date":"2020-12-26","times":"19:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-26","times":"23:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-26","times":"23:00:00","typeCode":"001","typeValue":"35"},{"date":"2020-12-26","times":"23:00:00","typeCode":"002","typeValue":"90"},{"date":"2020-12-26","times":"23:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-26","times":"23:00:00","typeCode":"003","typeValue":"38"},{"date":"2020-12-26","times":"23:00:00","typeCode":"015","typeValue":"39"},{"date":"2020-12-26","times":"23:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-27","times":"03:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-27","times":"03:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-27","times":"03:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-27","times":"03:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-27","times":"03:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-27","times":"03:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-27","times":"03:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-27","times":"07:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-27","times":"07:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-27","times":"07:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-27","times":"07:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-27","times":"07:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-27","times":"07:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-27","times":"07:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-27","times":"11:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-27","times":"11:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-27","times":"11:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-27","times":"11:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-27","times":"11:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-27","times":"11:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-27","times":"11:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-27","times":"15:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-27","times":"15:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-27","times":"15:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-27","times":"15:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-27","times":"15:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-27","times":"15:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-27","times":"15:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-27","times":"19:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-27","times":"19:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-27","times":"19:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-27","times":"19:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-27","times":"19:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-27","times":"19:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-27","times":"19:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-27","times":"23:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-27","times":"23:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-27","times":"23:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-27","times":"23:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-27","times":"23:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-27","times":"23:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-27","times":"23:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-28","times":"03:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-28","times":"03:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-28","times":"03:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-28","times":"03:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-28","times":"03:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-28","times":"03:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-28","times":"03:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-28","times":"07:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-28","times":"07:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-28","times":"07:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-28","times":"07:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-28","times":"07:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-28","times":"07:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-28","times":"07:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-28","times":"11:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-28","times":"11:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-28","times":"11:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-28","times":"11:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-28","times":"11:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-28","times":"11:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-28","times":"11:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-28","times":"15:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-28","times":"15:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-28","times":"15:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-28","times":"15:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-28","times":"15:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-28","times":"15:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-28","times":"15:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-28","times":"19:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-28","times":"19:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-28","times":"19:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-28","times":"19:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-28","times":"19:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-28","times":"19:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-28","times":"19:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-28","times":"23:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-28","times":"23:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-28","times":"23:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-28","times":"23:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-28","times":"23:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-28","times":"23:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-28","times":"23:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-29","times":"03:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-29","times":"03:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-29","times":"03:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-29","times":"03:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-29","times":"03:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-29","times":"03:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-29","times":"03:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-29","times":"07:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-29","times":"07:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-29","times":"07:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-29","times":"07:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-29","times":"07:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-29","times":"07:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-29","times":"07:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-29","times":"11:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-29","times":"11:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-29","times":"11:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-29","times":"11:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-29","times":"11:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-29","times":"11:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-29","times":"11:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-29","times":"15:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-29","times":"15:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-29","times":"15:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-29","times":"15:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-29","times":"15:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-29","times":"15:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-29","times":"15:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-29","times":"19:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-29","times":"19:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-29","times":"19:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-29","times":"19:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-29","times":"19:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-29","times":"19:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-29","times":"19:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-29","times":"23:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-29","times":"23:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-29","times":"23:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-29","times":"23:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-29","times":"23:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-29","times":"23:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-29","times":"23:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-30","times":"03:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-30","times":"03:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-30","times":"03:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-30","times":"03:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-30","times":"03:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-30","times":"03:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-30","times":"03:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-30","times":"07:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-30","times":"07:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-30","times":"07:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-30","times":"07:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-30","times":"07:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-30","times":"07:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-30","times":"07:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-30","times":"11:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-30","times":"11:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-30","times":"11:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-30","times":"11:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-30","times":"11:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-30","times":"11:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-30","times":"11:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-30","times":"15:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-30","times":"15:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-30","times":"15:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-30","times":"15:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-30","times":"15:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-30","times":"15:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-30","times":"15:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-30","times":"19:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-30","times":"19:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-30","times":"19:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-30","times":"19:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-30","times":"19:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-30","times":"19:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-30","times":"19:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-30","times":"23:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-30","times":"23:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-30","times":"23:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-30","times":"23:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-30","times":"23:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-30","times":"23:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-30","times":"23:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-31","times":"03:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-31","times":"03:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-31","times":"03:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-31","times":"03:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-31","times":"03:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-31","times":"03:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-31","times":"03:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-31","times":"07:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-31","times":"07:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-31","times":"07:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-31","times":"07:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-31","times":"07:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-31","times":"07:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-31","times":"07:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-31","times":"11:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-31","times":"11:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-31","times":"11:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-31","times":"11:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-31","times":"11:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-31","times":"11:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-31","times":"11:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-31","times":"15:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-31","times":"15:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-31","times":"15:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-31","times":"15:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-31","times":"15:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-31","times":"15:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-31","times":"15:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-31","times":"19:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-31","times":"19:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-31","times":"19:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-31","times":"19:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-31","times":"19:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-31","times":"19:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-31","times":"19:00:00","typeCode":"013","typeValue":null}]},{"rowBOS":[{"date":"2020-12-31","times":"23:00:00","typeCode":"012","typeValue":null},{"date":"2020-12-31","times":"23:00:00","typeCode":"001","typeValue":null},{"date":"2020-12-31","times":"23:00:00","typeCode":"002","typeValue":null},{"date":"2020-12-31","times":"23:00:00","typeCode":"014","typeValue":null},{"date":"2020-12-31","times":"23:00:00","typeCode":"003","typeValue":null},{"date":"2020-12-31","times":"23:00:00","typeCode":"015","typeValue":null},{"date":"2020-12-31","times":"23:00:00","typeCode":"013","typeValue":null}]}],"types":[{"date":"2020-12-25 00:00:00","times":null,"typeCode":"016","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"004","typeValue":"6"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"005","typeValue":"1"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"006","typeValue":"1000cc"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"007","typeValue":"50"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"008","typeValue":"110"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"009","typeValue":"55"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"010","typeValue":"无"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"020","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"021","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"022","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"023","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"024","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"025","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"026","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"027","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"028","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"029","typeValue":null},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"030","typeValue":"167"},{"date":"2020-12-25 00:00:00","times":null,"typeCode":"011","typeValue":"600cc"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"016","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"004","typeValue":"3"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"005","typeValue":"3"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"006","typeValue":"99"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"007","typeValue":"44"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"008","typeValue":"99"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"009","typeValue":"80"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"010","typeValue":"阿莫西林"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"020","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"021","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"022","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"023","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"024","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"025","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"026","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"027","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"028","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"029","typeValue":null},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"030","typeValue":"170"},{"date":"2020-12-26 00:00:00","times":null,"typeCode":"011","typeValue":"99"},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"016","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"004","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"005","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"006","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"007","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"008","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"009","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"010","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"020","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"021","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"022","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"023","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"024","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"025","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"026","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"027","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"028","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"029","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"030","typeValue":null},{"date":"2020-12-27 00:00:00","times":null,"typeCode":"011","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"016","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"004","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"005","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"006","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"007","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"008","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"009","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"010","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"020","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"021","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"022","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"023","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"024","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"025","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"026","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"027","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"028","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"029","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"030","typeValue":null},{"date":"2020-12-28 00:00:00","times":null,"typeCode":"011","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"016","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"004","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"005","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"006","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"007","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"008","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"009","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"010","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"020","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"021","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"022","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"023","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"024","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"025","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"026","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"027","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"028","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"029","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"030","typeValue":null},{"date":"2020-12-29 00:00:00","times":null,"typeCode":"011","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"016","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"004","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"005","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"006","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"007","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"008","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"009","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"010","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"020","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"021","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"022","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"023","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"024","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"025","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"026","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"027","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"028","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"029","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"030","typeValue":null},{"date":"2020-12-30 00:00:00","times":null,"typeCode":"011","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"016","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"004","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"005","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"006","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"007","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"008","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"009","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"010","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"020","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"021","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"022","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"023","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"024","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"025","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"026","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"027","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"028","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"029","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"030","typeValue":null},{"date":"2020-12-31 00:00:00","times":null,"typeCode":"011","typeValue":null}]}]'
  printData= JSON.parse(jsonStr)
  addPrintEvent()
  runTask()
});

function removeIframe (id) {
  var child = window.parent.document.getElementById(id)
  child.parentElement.removeChild(child)
}
function setTime (num) {
  return new Promise(resolve => {
    setTimeout(resolve, num)
  })
}
function addPrintEvent () {
  window.addEventListener('afterprint', () => {
    this.printPromiseReslove()
  })
}

async function runTask () {
  const weeks = printData.weekList
  for (let index = 0; index < weeks.length; index++) {
    const week = weeks[index]
    await getData(week)
  }
  try {
    removeIframe(this.$route.query.id)
  } catch (error) {
    window.location.href = 'about:blank'
  }
}

function  printPage () {
  window.print()
}


async function  getData (curWeekInfo) {
  resInfo = data
  if (graphicsDataDone) {
    graphicsDataDone = false
  }
  await setTime(10)
  graphicsDataDone = true
  return new Promise(resolve => {
    printPromiseReslove = resolve
  })
}
</script>

<style>
@page {
  margin-top: 0;
  margin-bottom: 0;
}
</style>
